# 專案技術清單

## 1. 網站折價券功能
- **功能說明** :
	1.	折價券活動的建立與管理
	•	支援多種活動類型（如登入送、匯入、異業合作等）。
	•	提供活動的啟用、停用、刪除與複製功能。
	•	支援活動的詳細設定，包括有效期限、折扣類型（定額或定率）、通路限定等。
	•	支援批次匯入客戶資料
	•	提供審核人員的管理與權限檢查功能。

- **技術使用**：C#, ASP.NET MVC, MSSQL
- **C# TransactionScope 確保資料一致性**：
    ```csharp
      public bool SaveVoucher(VoucherMaster voucher, string createdBy = "")
      {
          bool result = false;
      
          using (var transactionScope = new TransactionScope(TransactionScopeOption.Required, new TransactionOptions { IsolationLevel = IsolationLevel.ReadCommitted }))
          {
              if (voucher.ID != 0)
              {
                  result = VoucherRepository.UpdateVoucherMaster(voucher);
              }
              else
              {
                  voucher.ID = VoucherRepository.CreateVoucherMaster(voucher, createdBy);
                  result = voucher.ID > 0;
              }
      
              if (result)
              {
                  int order = 1;
                  VoucherRepository.DeleteVoucherDetails(voucher.ID);
                  foreach (var detail in voucher.Detail ?? Enumerable.Empty<VoucherDetail>())
                  {
                      VoucherRepository.InsertVoucherDetail(voucher.ID, detail, order++);
                  }
              }
      
              transactionScope.Complete();
          }
      
          return result;
      }
    ```

## 2. Facebook 登入
- **技術使用**：OAuth 2.0, Facebook SDK, C#
- **C# 範例**：
    ```csharp
    var result = await _fbClient.GetAsync("/me?fields=id,name,email");
    var user = JsonConvert.DeserializeObject<FacebookUser>(result);
    ```
- **MSSQL 位置**：
    ```sql
    INSERT INTO Users (FacebookId, Name, Email) VALUES (@FacebookId, @Name, @Email)
    ```

## 3. Linepay 串接
- **技術使用**：Line Pay API, C#
- **C# 範例**：
    ```csharp
    var response = await _linePayClient.RequestPaymentAsync(new PaymentRequest
    {
        Amount = 1000,
        OrderId = Guid.NewGuid().ToString()
    });
    ```
- **MSSQL 位置**：
    ```sql
    SELECT * FROM Payments WHERE OrderId = @OrderId
    ```

## 4. 悠遊付 串接
- **技術使用**：悠遊付 API, C#
- **C# 範例**：
    ```csharp
    var paymentResult = await _easyCardClient.MakePaymentAsync(new PaymentRequest
    {
        Amount = 500,
        TransactionId = Guid.NewGuid().ToString()
    });
    ```
- **MSSQL 位置**：
    ```sql
    SELECT * FROM Transactions WHERE TransactionId = @TransactionId
    ```

## 5. 遠信免卡分期付款方式
- **技術使用**：API 集成, C#
- **C# 範例**：
    ```csharp
    var installmentResponse = await _farEastBankClient.RequestInstallmentAsync(new InstallmentRequest
    {
        Amount = 2000,
        CreditCardNumber = "1234567890123456"
    });
    ```
- **MSSQL 位置**：
    ```sql
    SELECT * FROM Installments WHERE CreditCardNumber = @CreditCardNumber
    ```

## 6. 電子票券串接 (墨攻)
- **技術使用**：API 集成, C#
- **C# 範例**：
    ```csharp
    var ticketResponse = await _moGoClient.GetTicketAsync(ticketId);
    ```
- **MSSQL 位置**：
    ```sql
    SELECT * FROM Tickets WHERE TicketId = @TicketId
    ```

## 7. 樂賣系統建置
- **技術使用**：E-commerce, C#
- **C# 範例**：
    ```csharp
    public async Task AddProductToCartAsync(Guid productId)
    {
        var cart = await _dbContext.Carts.FirstOrDefaultAsync(c => c.UserId == userId);
        cart.Products.Add(new CartItem { ProductId = productId });
        await _dbContext.SaveChangesAsync();
    }
    ```
- **MSSQL 位置**：
    ```sql
    INSERT INTO CartItems (CartId, ProductId) VALUES (@CartId, @ProductId)
    ```

## 8. 網站MGM,登記型,任務型,投票活動建置
- **技術使用**：活動管理, C#
- **C# 範例**：
    ```csharp
    public async Task<bool> CreateVotingEventAsync(VotingEvent event)
    {
        _dbContext.VotingEvents.Add(event);
        await _dbContext.SaveChangesAsync();
        return true;
    }
    ```
- **MSSQL 位置**：
    ```sql
    INSERT INTO VotingEvents (EventName, StartDate, EndDate) VALUES (@EventName, @StartDate, @EndDate)
    ```

## 9. 登入 Recaptcha 驗證機制
- **技術使用**：Google Recaptcha, C#
- **C# 範例**：
    ```csharp
    var recaptchaResponse = await _recaptchaService.ValidateRecaptchaAsync(recaptchaToken);
    if (!recaptchaResponse.IsValid) 
    {
        throw new InvalidOperationException("Recaptcha validation failed");
    }
    ```
- **MSSQL 位置**：
    - 此功能無需 MSSQL 直接操作

## 10. 生活繳費 API 串接
- **技術使用**：API 集成, C#
- **C# 範例**：
    ```csharp
    var paymentResult = await _paymentClient.MakePaymentAsync(new PaymentRequest
    {
        Amount = 300,
        BillNumber = "BILL123456"
    });
    ```
- **MSSQL 位置**：
    ```sql
    SELECT * FROM Payments WHERE BillNumber = @BillNumber
    ```

## 11. 7-11 退貨便串接
- **技術使用**：API 集成, C#
- **C# 範例**：
    ```csharp
    var returnResponse = await _sevenElevenClient.ProcessReturnAsync(new ReturnRequest
    {
        OrderId = "12345",
        Reason = "Defective product"
    });
    ```
- **MSSQL 位置**：
    ```sql
    SELECT * FROM Returns WHERE OrderId = @OrderId
    ```

## 12. Line 平台規劃
- **技術使用**：Line Messaging API, C#
- **C# 範例**：
    ```csharp
    var pushMessageResponse = await _lineMessagingClient.PushMessageAsync(new LineMessage
    {
        To = "userId",
        Message = new TextMessage("Hello, World!")
    });
    ```
- **MSSQL 位置**：
    ```sql
    SELECT * FROM LineUsers WHERE UserId = @UserId
    ```

## 13. 專案重構 手機驗證流程 (註冊及基本資料維護)
- **技術使用**：SMS API, C#
- **C# 範例**：
    ```csharp
    var verificationCode = GenerateVerificationCode();
    var result = await _smsService.SendVerificationCodeAsync(userPhoneNumber, verificationCode);
    ```
- **MSSQL 位置**：
    ```sql
    UPDATE Users SET VerificationCode = @VerificationCode WHERE UserPhoneNumber = @UserPhoneNumber
    ```

---
