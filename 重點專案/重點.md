# Â∞àÊ°àÊäÄË°ìÊ∏ÖÂñÆ

## 1. Á∂≤Á´ôÊäòÂÉπÂà∏ÂäüËÉΩ
- **ÂäüËÉΩË™™Êòé**Ôºö
  1. **ÊäòÂÉπÂà∏Ê¥ªÂãïÁöÑÂª∫Á´ãËàáÁÆ°ÁêÜ**
     - ÊîØÊè¥Â§öÁ®ÆÊ¥ªÂãïÈ°ûÂûãÔºàÂ¶ÇÁôªÂÖ•ÈÄÅ„ÄÅÂåØÂÖ•„ÄÅÁï∞Ê•≠Âêà‰ΩúÁ≠âÔºâ„ÄÇ
     - Êèê‰æõÊ¥ªÂãïÁöÑÂïüÁî®„ÄÅÂÅúÁî®„ÄÅÂà™Èô§ËàáË§áË£ΩÂäüËÉΩ„ÄÇ
     - ÊîØÊè¥Ê¥ªÂãïÁöÑË©≥Á¥∞Ë®≠ÂÆöÔºåÂåÖÊã¨ÊúâÊïàÊúüÈôê„ÄÅÊäòÊâ£È°ûÂûãÔºàÂÆöÈ°çÊàñÂÆöÁéáÔºâ„ÄÅÈÄöË∑ØÈôêÂÆöÁ≠â„ÄÇ
     - ÊîØÊè¥ÊâπÊ¨°ÂåØÂÖ•ÂÆ¢Êà∂Ë≥áÊñô„ÄÇ
     - Êèê‰æõÂØ©Ê†∏‰∫∫Âì°ÁöÑÁÆ°ÁêÜËàáÊ¨äÈôêÊ™¢Êü•ÂäüËÉΩ„ÄÇ

- **ÊäÄË°ì‰ΩøÁî®**ÔºöC#, ASP.NET MVC, MSSQL
- **C# TransactionScope Á¢∫‰øùË≥áÊñô‰∏ÄËá¥ÊÄß**Ôºö
    ```csharp
      public bool SaveVoucher(VoucherMaster voucher, string createdBy = "")
      {
          bool result = false;
      
          using (var transactionScope = new TransactionScope(TransactionScopeOption.Required, new TransactionOptions { IsolationLevel = IsolationLevel.ReadCommitted }))
          {
              if (voucher.ID != 0)
              {
                  result = VoucherRepository.UpdateVoucherMaster(voucher);
              }
              else
              {
                  voucher.ID = VoucherRepository.CreateVoucherMaster(voucher, createdBy);
                  result = voucher.ID > 0;
              }
      
              if (result)
              {
                  int order = 1;
                  VoucherRepository.DeleteVoucherDetails(voucher.ID);
                  foreach (var detail in voucher.Detail ?? Enumerable.Empty<VoucherDetail>())
                  {
                      VoucherRepository.InsertVoucherDetail(voucher.ID, detail, order++);
                  }
              }
      
              transactionScope.Complete();
          }
      
          return result;
      }
    ```

## 2. Áõ¥Êí≠ÂñäÂñÆÁ≥ªÁµ±Âª∫ÁΩÆ
- **ÂäüËÉΩË™™Êòé**Ôºö
  1. **Facebook ÁôªÂÖ•Êï¥Âêà**
     - ‰ΩøÁî® OWIN Êê≠ÈÖç ASP.NET Identity ÂÆåÊàêÁ¨¨‰∏âÊñπÁôªÂÖ•„ÄÇ
  
  2. **Á≤âÁµ≤ÂúòËÅäÂ§©ÂÆ§Ë®ÇÈñ±ÁÆ°ÁêÜ**
     - ‰ΩøÁî® Redis Âø´ÂèñÁ≤âÁµ≤ÂúòËÅäÂ§©ÂÆ§Ëàá SignalR ConnectId ÁöÑÂ∞çÊáâÈóú‰øÇ„ÄÇ

  3. **Webhook Êé®Êí≠Ëá≥ËÅäÂ§©ÂÆ§**
     - ÂæåÂè∞Êé•Êî∂Âà∞ webhook Ë®äÊÅØÂæåÔºåÊü•Ë©¢ Redis ‰∏≠Â∞çÊáâÁ≤âÁµ≤ÂúòËÅäÂ§©ÂÆ§ÁöÑ SignalR ConnectId„ÄÇ
     - ‰ΩøÁî® SignalR Â∞áË®äÊÅØÂç≥ÊôÇÊé®ÈÄÅËá≥Â∞çÊáâÁöÑËÅäÂ§©ÂÆ§ÈÄ£Á∑öÁ´Ø„ÄÇ
	 
  4. **Facebook API Êé®ÈÄÅË≥ºÁâ©ÈÄ£Áµê**
     - webhookÊî∂Âà∞Ë®äÊÅØÁ∂ìÈÅéÂàÜÊûêÈóúÈçµÂ≠óÊØîÂ∞çÂêªÂêà,ÈÄèÈÅéfacebook apiÁôºÈÄÅË≥ºÁâ©ÈÄ£ÁµêÁµ¶Áî®Êà∂„ÄÇ

- **ÊäÄË°ì‰ΩøÁî®**ÔºöC#, ASP.NET MVC, MSSQL, Redis, SignalR, Facebook API, ASP.NET Identity, OWIN




## 3. Á¨¨‰∏âÊñπÊîØ‰ªò‰∏≤Êé•
- **ÂäüËÉΩË™™Êòé**Ôºö
  1. ÊñºÈõªÂïÜÂπ≥Âè∞‰∏≠ÔºåË®ÇÂñÆÊàêÁ´ãÂæåËá™ÂãïÂ∞éÂêëÁ¨¨‰∏âÊñπÊîØ‰ªòÊµÅÁ®ãÔºå‰∏¶‰æùÊìöÊîØ‰ªòÁµêÊûúÊõ¥Êñ∞Ë®ÇÂñÆÁãÄÊÖã„ÄÇ
  2. ÊîØÊè¥Â§öÁ®ÆÊîØ‰ªòÂπ≥Âè∞‰∏≤Êé•Ôºö
     - **LinePay**
     - **ÊÇ†ÈÅä‰ªò**
     - **iPASS ‰∏ÄÂç°ÈÄö**
  3. ‰∏≤Êé•ÈÅéÁ®ãÂåÖÂê´Á∞ΩÁ´†È©óË≠â„ÄÅË®ÇÂñÆËôüÂ∞çÊáâ„ÄÅÂõûÂÇ≥ÁµêÊûúËß£ÊûêËàáÁï∞Â∏∏ËôïÁêÜ„ÄÇ

- **ÊäÄË°ì‰ΩøÁî®**ÔºöC#, ASP.NET Core, ASP.NET MVC, MSSQL, Oracle, Redis

	
## 4. Â∞éÂÖ• Google Recaptcha È©óË≠â
- **ÂäüËÉΩË™™Êòé**Ôºö
  1. ÊáâÁî®ÊñºË®ªÂÜä„ÄÅÁôªÂÖ•ËàáÊïèÊÑüÊìç‰ΩúÔºàÂ¶ÇÈáçË®≠ÂØÜÁ¢ºÔºâ‰∏≠ÔºåÈò≤Ê≠¢Ê©üÂô®‰∫∫Êø´Áî®Ë°åÁÇ∫„ÄÇ
  2. ‰ΩøÁî® Google RecaptchaÔºåÊèêÂçáÁ∂≤Á´ôÂÆâÂÖ®ÊÄßËàá‰ΩøÁî®ËÄÖÈ´îÈ©ó„ÄÇ
  3. Â∞áÈ©óË≠âÈÅéÁ®ãÁî¢ÁîüÁöÑÂàÜÊï∏Á¥ÄÈåÑÊé•ÂÖ• ELK Log Á≥ªÁµ±Ôºå‰æõÂæåÁ∫åËøΩËπ§ËàáË™øÊü•„ÄÇ
  4. Â∞éÂÖ•ÂæåËá™ÂãïÊ†πÊìöÈ©óË≠âÁµêÊûúÊéßÂà∂ÊòØÂê¶ÁπºÁ∫åÂü∑Ë°åÂæåÁ∫åÊµÅÁ®ã„ÄÇ

- **ÊäÄË°ì‰ΩøÁî®**ÔºöC#, ASP.NET MVC, Google Recaptcha, ELK


## 5. LineÂπ≥Âè∞Êî∂ÈõÜÈõÜÂúòÂÆòÊñπÂ∏≥Ëôüwebhook

# WebHook ËôïÁêÜÈÇèËºØ‰∏≠ÁöÑË®≠Ë®àÊ®°ÂºèÊáâÁî®

Êú¨ÊÆµÁ®ãÂºèÁ¢ºÈÅãÁî®‰∫ÜÂÖ©Á®ÆÂ∏∏Ë¶ãÁöÑË®≠Ë®àÊ®°ÂºèÔºö

- **Factory PatternÔºàÂ∑•Âª†Ê®°ÂºèÔºâ**
- **Strategy PatternÔºàÁ≠ñÁï•Ê®°ÂºèÔºâ**

ÈÅîÊàêÈ´òÂΩàÊÄß„ÄÅÈ´òÂèØÁ∂≠Ë≠∑ÊÄßÁöÑ‰∫ã‰ª∂ËôïÁêÜÊ©üÂà∂„ÄÇ

---

## üéØ Factory Pattern - Â∑•Âª†Ê®°Âºè

### ‰ΩøÁî®Â†¥ÊôØ

‰ΩøÁî® `IHandlerFactory` ‰ªãÈù¢ + `GetHandler()` ÊñπÊ≥ïÔºåÊ†πÊìö `WebHookEventType` Âª∫Á´ãÂ∞çÊáâÁöÑ‰∫ã‰ª∂ËôïÁêÜÂô®Áâ©‰ª∂„ÄÇ

### Á®ãÂºèÁ¢ºÁØÑ‰æã

```csharp
public interface IHandlerFactory
{
    IWebHookEventHandler GetHandler(WebHookEventType type, BotInfo botInfo, ILineBot bot);
}

public class HandlerFactory : IHandlerFactory
{
    public IWebHookEventHandler GetHandler(WebHookEventType type, BotInfo botInfo, ILineBot bot)
    {
        BaseWebHookEventHandler handler = type switch
        {
            WebHookEventType.Follow => new FollowWebHookEventHandler(...),
            WebHookEventType.Message => new MessageWebHookEventHandler(...),
            _ => new IdleWebHookEventHandler(...)
        };

        return handler;
    }
}

 public abstract class BaseWebHookEventHandler : IWebHookEventHandler
 {
     /// <summary>
     /// ÂêÑ handler ÂØ¶‰ΩúËôïÁêÜ‰∫ã‰ª∂
     /// </summary>
     protected abstract Task Handle(LineEvent lineEvent, BotInfo botInfo, DateTime executeTime);

     public async Task Execute(LineEvent lineEvent, BotInfo botInfo)
     {
         await Handle(lineEvent, botInfo, now);

         CreateWebhookEvent(WebHookEvent, now);
     }
  }
  public interface IWebHookEventHandler
  {

      Task Execute(LineEvent lineEvent, BotInfo botInfo);
  }

  public interface IMessageWebHookEventHandler : IWebHookEventHandler
  {}

public class FollowWebHookEventHandler : BaseWebHookEventHandler, IFollowWebHookEventHandler
{

    protected override async Task Handle(LineEvent lineEvent, BotInfo botInfo, DateTime executeTime)
    {
        var user = InittestUser(botInfo, profile, hashname, executeTime);

        _userModule.UpsertUser(user);
    }
}